<mat-card *ngIf="currentRoute$ | async as route">
  <ng-container *ngIf="route.url.startsWith('/c/') ? 'انجمن' : 'بلاگ' as type">
    <mat-card-header>
      <mat-card-title>ساخت {{ type }} جدید</mat-card-title>
      <mat-card-subtitle>subtitle</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <form [formGroup]='form'>
        <mat-form-field>
          <input formControlName="sname" matInput [placeholder]="'نام ' + type" required />
          <mat-hint class="fs-small">توجه: این نام بعدا قابل تغییر نیست</mat-hint>
        </mat-form-field>
        <mat-form-field>
          <mat-label>توضیحات</mat-label>
          <textarea formControlName="description" required #box matInput maxlength="250" cdkTextareaAutosize
            cdkAutosizeMinRows="1" cdkAutosizeMaxRows="8"></textarea>
          <mat-hint class="fs-small">
            در اینجا دلیل اینکه افراد جدید به {{type}} شما بپیوندند را بنویسید
          </mat-hint>
        </mat-form-field>
        <mat-form-field dir="ltr">
          <mat-label class="text-persian">موضوع اصلی</mat-label>
          <mat-select formControlName="subject" required>
            <mat-option class="text-persian" *ngFor="let subject of ['هنر', 'برنامه نویسی']" [value]="subject">
              {{subject}}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field class="example-chip-list">
          <mat-chip-list #chipList aria-label="انتخاب زیرموضوعات">
            <mat-chip style="padding-top: 6px;padding-bottom: 5px;" *ngFor="let flair of selectedFlairs"
              (removed)="removeFlair(flair)">
              <mat-icon matChipRemove>cancel</mat-icon>
              {{ flair }}
            </mat-chip>
            <input formControlName="flairs" placeholder="زیر موضوعات (اختیاری)" #flairInput [matAutocomplete]="auto"
              [matChipInputFor]="chipList" [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
              (matChipInputTokenEnd)="addFlair($event)" />
          </mat-chip-list>
          <mat-autocomplete #auto="matAutocomplete" (optionSelected)="clickFlair($event)">
            <mat-option class="text-persian fs-normal" *ngFor="let flair of filteredFlairs | async" [value]="flair">
              {{ flair.viewValue }}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>
      </form>
    </mat-card-content>
    <mat-card-actions>
      <ng-container *ngIf="social$ | async as social">
        <button [disabled]="social.loading || form.invalid" (click)="onCreate(type === 'انجمن' ? 'forum' : 'blog')"
          class="btn mb-1" mat-raised-button color="primary">
          <span *ngIf="!social.loading else loading">
            ساخت
            {{ type }}
          </span>
          <ng-template #loading>
            <mat-spinner style="margin: 6px auto;" color="accent" [diameter]="25">
            </mat-spinner>
          </ng-template>
        </button>
      </ng-container>
    </mat-card-actions>
  </ng-container>
</mat-card>
